<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블랙-숄즈 옵션 계산기 - 파생상품론 시뮬레이터</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Noto+Serif+KR:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            color: #667eea;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-button">← 메인으로 돌아가기</a>
    
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        
        const normCDF = (x) => {
          const t = 1 / (1 + 0.2316419 * Math.abs(x));
          const d = 0.3989423 * Math.exp(-x * x / 2);
          const prob = d * t * (0.3193815 + t * (-0.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))));
          return x > 0 ? 1 - prob : prob;
        };

        const normPDF = (x) => {
          return Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
        };

        const calculateBlackScholes = (S, K, T, r, sigma, optionType) => {
          if (S <= 0 || K <= 0 || T <= 0 || sigma <= 0) return null;

          const d1 = (Math.log(S / K) + (r + 0.5 * sigma * sigma) * T) / (sigma * Math.sqrt(T));
          const d2 = d1 - sigma * Math.sqrt(T);

          let price, delta, rho;

          if (optionType === 'call') {
            price = S * normCDF(d1) - K * Math.exp(-r * T) * normCDF(d2);
            delta = normCDF(d1);
            rho = K * T * Math.exp(-r * T) * normCDF(d2) / 100;
          } else {
            price = K * Math.exp(-r * T) * normCDF(-d2) - S * normCDF(-d1);
            delta = normCDF(d1) - 1;
            rho = -K * T * Math.exp(-r * T) * normCDF(-d2) / 100;
          }

          const gamma = normPDF(d1) / (S * sigma * Math.sqrt(T));
          const theta1 = -(S * normPDF(d1) * sigma) / (2 * Math.sqrt(T));
          const theta2 = optionType === 'call' 
            ? -r * K * Math.exp(-r * T) * normCDF(d2)
            : r * K * Math.exp(-r * T) * normCDF(-d2);
          const theta = (theta1 + theta2) / 365;
          const vega = S * normPDF(d1) * Math.sqrt(T) / 100;

          return { price, delta, gamma, theta, vega, rho, d1, d2 };
        };
        
        const OptionPriceCalculator = () => {
          const [optionType, setOptionType] = useState('call');
          const [spotPrice, setSpotPrice] = useState('');
          const [strikePrice, setStrikePrice] = useState('');
          const [timeToMaturity, setTimeToMaturity] = useState('');
          const [riskFreeRate, setRiskFreeRate] = useState('');
          const [volatility, setVolatility] = useState('');
          const [result, setResult] = useState(null);

          const calculateOption = () => {
            const S = parseFloat(spotPrice);
            const K = parseFloat(strikePrice);
            const T = parseFloat(timeToMaturity);
            const r = parseFloat(riskFreeRate) / 100;
            const sigma = parseFloat(volatility) / 100;

            if (isNaN(S) || isNaN(K) || isNaN(T) || isNaN(r) || isNaN(sigma)) {
              alert('모든 값을 올바르게 입력해주세요.');
              return;
            }

            if (S <= 0 || K <= 0 || T <= 0 || sigma <= 0) {
              alert('모든 값은 양수여야 합니다.');
              return;
            }

            const calculated = calculateBlackScholes(S, K, T, r, sigma, optionType);
            if (calculated) {
              setResult({
                ...calculated,
                inputs: { S, K, T, r: r * 100, sigma: sigma * 100, optionType }
              });
            }
          };

          const resetForm = () => {
            setSpotPrice('');
            setStrikePrice('');
            setTimeToMaturity('');
            setRiskFreeRate('');
            setVolatility('');
            setResult(null);
          };

          return (
            <div className="w-full max-w-6xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-20 font-sans">
              <div className="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-3 rounded-t-lg -m-6 mb-6">
                <h2 className="text-lg font-bold font-serif">블랙-숄즈 옵션 가격 계산기</h2>
                <p className="text-blue-100 text-xs mt-0.5">Black-Scholes Option Pricing Model</p>
              </div>

              <div className="grid grid-cols-5 gap-6">
                <div className="col-span-1 space-y-4">
                  <h3 className="text-lg font-bold text-gray-800 border-b-2 border-blue-300 pb-2 font-serif">
                    입력 파라미터
                  </h3>

                  <div className="space-y-3">
                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">옵션 유형</label>
                      <div className="space-y-1.5">
                        <label className="flex items-center cursor-pointer px-2 py-1.5 rounded bg-white border border-blue-300 hover:border-blue-500 transition-colors text-xs">
                          <input type="radio" value="call" checked={optionType === 'call'} onChange={(e) => setOptionType(e.target.value)} className="mr-2 w-3 h-3 text-blue-600" />
                          <span className="font-medium">콜 (Call)</span>
                        </label>
                        <label className="flex items-center cursor-pointer px-2 py-1.5 rounded bg-white border border-blue-300 hover:border-blue-500 transition-colors text-xs">
                          <input type="radio" value="put" checked={optionType === 'put'} onChange={(e) => setOptionType(e.target.value)} className="mr-2 w-3 h-3 text-blue-600" />
                          <span className="font-medium">풋 (Put)</span>
                        </label>
                      </div>
                    </div>

                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">기초자산 가격 (S)</label>
                      <input type="number" step="0.01" value={spotPrice} onChange={(e) => setSpotPrice(e.target.value)} placeholder="예: 100" className="w-full px-3 py-1.5 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" />
                    </div>

                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">행사가격 (K)</label>
                      <input type="number" step="0.01" value={strikePrice} onChange={(e) => setStrikePrice(e.target.value)} placeholder="예: 100" className="w-full px-3 py-1.5 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" />
                    </div>

                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">만기 (T, 년)</label>
                      <input type="number" step="0.01" value={timeToMaturity} onChange={(e) => setTimeToMaturity(e.target.value)} placeholder="예: 1" className="w-full px-3 py-1.5 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" />
                    </div>

                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">무위험이자율 (r, %)</label>
                      <input type="number" step="0.01" value={riskFreeRate} onChange={(e) => setRiskFreeRate(e.target.value)} placeholder="예: 5" className="w-full px-3 py-1.5 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" />
                    </div>

                    <div>
                      <label className="block text-xs font-medium mb-1 text-gray-700">변동성 (σ, %)</label>
                      <input type="number" step="0.01" value={volatility} onChange={(e) => setVolatility(e.target.value)} placeholder="예: 20" className="w-full px-3 py-1.5 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" />
                    </div>
                  </div>

                  <div className="flex gap-2 pt-2">
                    <button onClick={calculateOption} className="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold text-sm shadow-md">계산하기</button>
                    <button onClick={resetForm} className="flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition-colors font-semibold text-sm shadow-md">초기화</button>
                  </div>
                </div>

                <div className="col-span-4 space-y-4">
                  <h3 className="text-lg font-bold text-gray-800 border-b-2 border-blue-300 pb-2 font-serif">계산 결과</h3>

                  {result ? (
                    <>
                      <div className="p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border-2 border-blue-300">
                        <p className="text-xs text-gray-600 mb-1">{result.inputs.optionType === 'call' ? '콜 옵션' : '풋 옵션'} 이론가격</p>
                        <p className="text-3xl font-bold text-blue-600">{result.price.toFixed(4)}</p>
                      </div>

                      <div className="p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-lg border border-yellow-300">
                        <h4 className="text-sm font-bold mb-3 text-yellow-800 font-serif">Greeks (민감도 지표)</h4>
                        <div className="space-y-2">
                          <div className="bg-white p-2.5 rounded border-l-4 border-blue-500">
                            <div className="flex items-center justify-between">
                              <span className="text-xs font-semibold text-gray-600">Delta (Δ)</span>
                              <span className="text-lg font-bold text-blue-600">{result.delta.toFixed(4)}</span>
                            </div>
                            <p className="text-xs text-gray-500 mt-0.5">기초자산 1원 변화 시 옵션가격 변화</p>
                          </div>

                          <div className="bg-white p-2.5 rounded border-l-4 border-green-500">
                            <div className="flex items-center justify-between">
                              <span className="text-xs font-semibold text-gray-600">Gamma (Γ)</span>
                              <span className="text-lg font-bold text-green-600">{result.gamma.toFixed(4)}</span>
                            </div>
                            <p className="text-xs text-gray-500 mt-0.5">기초자산 1원 변화 시 Delta 변화</p>
                          </div>

                          <div className="bg-white p-2.5 rounded border-l-4 border-red-500">
                            <div className="flex items-center justify-between">
                              <span className="text-xs font-semibold text-gray-600">Theta (Θ)</span>
                              <span className="text-lg font-bold text-red-600">{result.theta.toFixed(4)}</span>
                            </div>
                            <p className="text-xs text-gray-500 mt-0.5">하루 경과 시 옵션가격 변화</p>
                          </div>

                          <div className="bg-white p-2.5 rounded border-l-4 border-purple-500">
                            <div className="flex items-center justify-between">
                              <span className="text-xs font-semibold text-gray-600">Vega (ν)</span>
                              <span className="text-lg font-bold text-purple-600">{result.vega.toFixed(4)}</span>
                            </div>
                            <p className="text-xs text-gray-500 mt-0.5">변동성 1% 변화 시 옵션가격 변화</p>
                          </div>

                          <div className="bg-white p-2.5 rounded border-l-4 border-orange-500">
                            <div className="flex items-center justify-between">
                              <span className="text-xs font-semibold text-gray-600">Rho (ρ)</span>
                              <span className="text-lg font-bold text-orange-600">{result.rho.toFixed(4)}</span>
                            </div>
                            <p className="text-xs text-gray-500 mt-0.5">금리 1% 변화 시 옵션가격 변화</p>
                          </div>
                        </div>
                      </div>
                    </>
                  ) : (
                    <div className="h-full flex items-center justify-center p-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
                      <div className="text-center text-gray-500">
                        <p className="text-sm font-medium">왼쪽에서 입력값을 입력하고<br/>계산하기 버튼을 눌러주세요</p>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };
        
        ReactDOM.render(<OptionPriceCalculator />, document.getElementById('root'));
    </script>
</body>
</html>
